<script src="/PublishedContent/js/BasicCTSResultsPage.js" type="text/javascript"></script>

#macro(DrawLocationInformation $trial)
  <strong>Location: </strong>
  #if ($trial.GetUSLocations().length == 1)
    #set($loc = $trial.GetUSLocations().get(0))
    $loc.FacilityName, $loc.PostalAddress.City, $loc.PostalAddress.PoliticalSubUnitName
  #elseif ($trial.GetUSLocations().length == 0)
    See <a href="https://www.clinicaltrials.gov/show/$trial.NCTID">Clinical Trials.gov</a>
  #else
    #if ($SearchResults.Control.HasZip())
      $trial.GetUSLocations().length locations, including $trial.GetUSLocations($SearchResults.Control.SearchParams.ZipLookup.GeoCode, $SearchResults.Control.SearchParams.ZipRadius).length near you
    #else
      $trial.GetUSLocations().length locations
    #end
  #end
  <br>
#end

#macro(DrawResults $SearchResults)
  <div class="cts-results-container">
    #foreach($resultItem in $SearchResults.Results.Results)
      #each
        ## Attach Onclick for Analytics elsewhere
        <a href="$SearchResults.Control.GetDetailedViewUrl($resultItem.NCTID)" class="protocol-abstract-link">$resultItem.BriefTitle</a>
        <div>
          <strong>Status: </strong>$resultItem.CurrentProtocolStatus<br>
          <strong>Age: </strong>$resultItem.Eligibility.AgeText<br>
          <strong>Gender: </strong>$resultItem.Eligibility.Gender<br>
			    #DrawLocationInformation($resultItem)
		    </div>
        <br>
        <br>
      #before
        <div class="row collapse">
        <div class="medium-12 columns clinical-trial-individual-result">
      #after
        </div>
        </div>
      #nodata
      No Items
    #end
    </div>

    ## If there are results then...
    <div class="ct-results-lower-control">
      <div class="pagination">
        ## Get Curr Page

        ## Shows 3 before and 3 after
        #foreach($pagerItem in $SearchResults.Control.GetPagerItems(3,3,$SearchResults.Results.TotalResults))
          #each
            #if($pagerItem.Text == $SearchResults.Control.SearchParams.Page.ToString())
              <span>$pagerItem.Text</span>
            #else
              <a href="$pagerItem.PageUrl">$pagerItem.Text</a>
            #end
          #after
            &nbsp;
        #end
      </div>
    </div>
  </div>
#end

<div class="large-9 columns">
  #if($SearchResults.Results.TotalResults > 0)
    #if($SearchResults.Control.HasInvalidParams() == false)
      <h5 id="ui-id-4">
        Results $SearchResults.Control.GetStartItemNum()-$SearchResults.Control.GetEndItemNum($SearchResults.Results.TotalResults) of $SearchResults.Results.TotalResults for: $SearchResults.Control.GetParamsList()
      </h5>
      <br>
      #DrawResults($SearchResults)
    #else
      <p>No results were found matching your criteria.</p>
      <li>Please check if your spelling is correct.</li>
      <li>Please check if your zip code and age are valid.</li>
      <p>For assistance, please contact our Cancer Information Service. You can <a href="/contact">chat online</a> or call 1-800-4CANCER (1-800-622-6237).</p>
      <br>
      <a href="/about-cancer/treatment/clinical-trials/search">Try a new search</a>
    #end
  ## If there are no results, then we need to show a different message
  #else
    <p>No clinical trials matched your search for $SearchResults.Control.NoResultsParams().</p>
    <p>For assistance, please contact our Cancer Information Service. You can <a href="/contact">chat online</a> or call 1-800-4CANCER (1-800-622-6237).</p>
    <br>
    <a href="/about-cancer/treatment/clinical-trials/search">Try a new search</a>
  #end
</div>
  
## Begin "Delighter" section ##
<div class="delighter-rail large-3 columns">
  <div class="delighter cts-livehelp">
		<h4>Have a question?</h4>
		<p>We're here to help</p><hr/>
		<p><a href='/contact'>Chat with us: <span class="live-help-button"><img alt="LiveHelp" src="/publishedcontent/images/images/spacer.gif"></span></a></p>
		<p><a href="tel:1-800-422-2637">Call us: <span>1-800-4-CANCER</span></a></p>
		<p><a href="tel:1-800-422-2637"><span>(1-800-422-6237)</span></a></p>
	</div>
  <a href="/about-cancer/treatment/clinical-trials/search/trial-guide">
    <div class="delighter cts-next-step">
      <h4>I’ve found a trial—what’s my next step?</h4>
      <hr/>
      <p>Refer to our guide on how to join a treatment trial.</p>
    </div>
  </a>
</div>