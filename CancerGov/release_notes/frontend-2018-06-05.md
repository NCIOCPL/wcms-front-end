# Frontend-2018-06-05

# Table of Contents
1. [Summary](#summary)
2. [Deployment Steps](#deploy)
3. [Content Changes](#content-changes)
    1. [Find a Cancer Center](#cc)

---

<a name="summary"></a>
## Summary
This release is focused on implementing a new map tile system for the [Find A Cancer Center](https://www.cancer.gov/research/nci-role/cancer-centers/find/) page. We've implemented an mapping library called [Leaflet](https://leafletjs.com/) that allows us to easily swap out map tile providers like Google Maps, Map Box, Open Street View and HEREmaps. A full [list of providers](http://leaflet-extras.github.io/leaflet-providers/preview/) can be demoed online.

#### Note:
If you need to change the map tile system, look in `/CancerGov/_src/Scripts/NCI/UX/Common/Enhancements/cancer-centers-map.js`. Inside the function `generateMap` are some commented out blocks that show how to load Open Street Maps and Map Box tiles using the `L.tileLayer` method. Only one tileLayer can be active at a time. The Map Box tile layer is using my (alifr) personal dev token. Please update this with an NCI token if you plan on using Map Box.

<a name="deploy"></a>
## Deployment Steps
1. Add a new `Internal JavaScript Info` asset to percussion in the `/Sites/CancerGov/Configuration/js` folder and published it when finished
    *  System Name: CancerCenterMap
    *  Title Name: CancerCenterMap
    *  Long Description: Map for "Find a Cancer Center" powered by Leaflet
    *  Short Description: Maps powered by Leaflet
    *  Browser Title: Cancer Centers Map
    *  Pretty URL Name: cancer-centers-map.js
    *  Name: CancerCentersMap.js
    *  File: Upload the new `CancerCentersMap.js` file in the release `js` folder
    *  Load Deferred: Checked
2. Update all the necessary css files in `/Sites/CancerGov/Configuration/css`. New styles have been added to `InnerPage.css`. Remember, all CSS files must be updated so that they are using the same timestamped sprite.
    *  It's ok to exclude `print_nci.css`, `nci.css`, and `widget.css`. They are not in the build process.

<a name="content-changes"></a>
## Content Changes


<a name="cc"></a>
### Find a Cancer Center
1. Create a new `Raw HTML Content Block` with the title: **Map with UI Controls** and fill the body field with the markup below

**Location:** /Sites/CancerGov/research/nci-role/cancer-centers/find/Map with UI Controls

```html
<div class="rawHtml">
  <p>
    <a href="/research/nci-role/cancer-centers">NCI-Designated Cancer Centers</a>
    deliver cutting-edge cancer treatments to patients in communities across the United States. Find a center near you and learn about its patient services and research capabilities.</p>

  <div id="mapWrapper">
    <h3 id="findCCTitle">Find Cancer Centers on map by:</h3>
    <div class='selectMenus'>

      <div class="dropDownCCDisplay">
        <label for="regionSelect">Choose Region:</label>
        <select id="regionSelect">
          <option value="">Select a region</option>
          <option value="newengland">New England</option>
          <option value="midatlantic">Mid-Atlantic</option>
          <option value="eastnorthcentral">East North Central</option>
          <option value="westnorthcentral">West North Central</option>
          <option value="southatlantic">South Atlantic</option>
          <option value="eastsouthcentral">East South Central</option>
          <option value="westsouthcentral">West South Central</option>
          <option value="mountain">Mountain</option>
          <option value="pacific">Pacific</option>
        </select>
      </div>

      <div class="dropDownCCDisplay">
        <label for="stateSelect">Choose State:</label>
        <select id="stateSelect">
          <option value="">Select a state</option>
          <option value="alabama">Alabama</option>
          <option value="alaska">Alaska</option>
          <option value="arizona">Arizona</option>
          <option value="arkansas">Arkansas</option>
          <option value="california">California</option>
          <option value="colorado">Colorado</option>
          <option value="connecticut">Connecticut</option>
          <option value="delaware">Delaware</option>
          <option value="dc">District of Columbia</option>
          <option value="florida">Florida</option>
          <option value="georgia">Georgia</option>
          <option value="hawaii">Hawaii</option>
          <option value="idaho">Idaho</option>
          <option value="illinois">Illinois</option>
          <option value="indiana">Indiana</option>
          <option value="iowa">Iowa</option>
          <option value="kansas">Kansas</option>
          <option value="kentucky">Kentucky</option>
          <option value="louisiana">Louisiana</option>
          <option value="maine">Maine</option>
          <option value="maryland">Maryland</option>
          <option value="massachusetts">Massachusetts</option>
          <option value="michigan">Michigan</option>
          <option value="minnesota">Minnesota</option>
          <option value="mississippi">Mississippi</option>
          <option value="missouri">Missouri</option>
          <option value="montana">Montana</option>
          <option value="nebraska">Nebraska</option>
          <option value="nevada">Nevada</option>
          <option value="new-hampshire">New Hampshire</option>
          <option value="new-jersey">New Jersey</option>
          <option value="new-mexico">New Mexico</option>
          <option value="new-york">New York</option>
          <option value="north-carolina">North Carolina</option>
          <option value="north-dakota">North Dakota</option>
          <option value="ohio">Ohio</option>
          <option value="oklahoma">Oklahoma</option>
          <option value="oregon">Oregon</option>
          <option value="pennsylvania">Pennsylvania</option>
          <option value="rhode-island">Rhode Island</option>
          <option value="south-carolina">South Carolina</option>
          <option value="south-dakota">South Dakota</option>
          <option value="tennessee">Tennessee</option>
          <option value="texas">Texas</option>
          <option value="utah">Utah</option>
          <option value="vermont">Vermont</option>
          <option value="virginia">Virginia</option>
          <option value="washington">Washington</option>
          <option value="west-virginia">West Virginia</option>
          <option value="wisconsin">Wisconsin</option>
          <option value="wyoming">Wyoming</option>
        </select>
      </div>

    </div>
  </div>


  <!-- This is the DIV which holds the map -->
  <div id="map-container"></div>
</div>

<div>
  <div>
    <img src="/PublishedContent/Images/images/cancercenter_icon.png" alt="red marker" /> = Cancer Center
    <sup>
      <a href="#cc1">1</a>
    </sup>
  </div>
  <div>
    <img src="/PublishedContent/Images/images/comprehensivecancercenter_icon.png" alt="blue marker" /> = Comprehensive Cancer Center
    <sup>
      <a href="#cc1">1</a>
    </sup>
  </div>
  <div>
    <img src="/PublishedContent/Images/images/researchcancercenter_icon.png" alt="yellow marker" /> = Basic Laboratory
    <sup>
      <a href="#cc1">1</a>
    </sup>
  </div>
</div>

<p class="menu-header__filler">OR</p>

<div id="picker">
  <h3 id="findCCTitle">Find Cancer Centers listed by:</h3>
  <fieldset class="button-group--maps">
    <label for="loc-region">Region</label>
    <input type="radio" name="location" id="loc-region" value='listing-region' checked />
    <label for="loc-state">State</label>
    <input type="radio" name="location" id="loc-state" value='listing-state' />
    <label for="loc-name">Name</label>
    <input type="radio" name="location" id="loc-name" value='listing-name' />
  </fieldset>
</div>

<script>
$(function () { 
  var CancerCentersMap = new CC_Map();
  CancerCentersMap.bindDropdowns();
  CancerCentersMap.listingToggle();
});
</script>
```

2. Switch to the `CancerGov` community
3. Update the `Find a Cancer Center` `General` page
**Location:** /Sites/CancerGov/research/nci-role/cancer-centers/find/Find a Cancer Center
    1. Go to `related content` and select `edit all` to update slots
    2. Remove `Nokia Maps code` from `CancerGov Body` 
    3. Add `Map with UI Controls` to the top of `CancerGov Body` 
    4. Remove `NCI-Designated Cancer Centers Map (No Article Crop)` from `Image Slot`
    5. Add `CancerCentersMap` from `Configuration/js` to `JavaScript Info Slot`
    6. Save changes

4. Push all edited edited files through publication.